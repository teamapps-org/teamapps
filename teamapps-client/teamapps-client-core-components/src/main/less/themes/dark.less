/*-
 * ========================LICENSE_START=================================
 * TeamApps
 * ---
 * Copyright (C) 2014 - 2022 TeamApps.org
 * ---
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================LICENSE_END==================================
 */
@ta-dark-color-primary: rgb(55, 90, 127);
@ta-dark-color-success: rgb(0, 188, 140);
@ta-dark-color-info: rgb(52, 152, 219);
@ta-dark-color-warning: rgb(243, 156, 18);
@ta-dark-color-danger: rgb(231, 76, 60);

@ta-dark-text-color: #f3f3f3;
@ta-dark-text-color-inverted: black;

@ta-dark-state-primary-text:             @ta-dark-text-color;
@ta-dark-state-primary-text-emphasis:    darken(@ta-dark-text-color, 10%);
@ta-dark-state-primary-bg:               @ta-dark-color-primary;
@ta-dark-state-primary-border:           darken(spin(@ta-dark-text-color, -10), 5%);

@ta-dark-state-success-text:             @ta-dark-text-color;
@ta-dark-state-success-text-emphasis:    average(@ta-dark-text-color, @ta-dark-color-success);
@ta-dark-state-success-bg:               @ta-dark-color-success;
@ta-dark-state-success-border:           darken(spin(@ta-dark-state-success-bg, -10), 5%);

@ta-dark-state-info-text:                @ta-dark-text-color;
@ta-dark-state-info-text-emphasis:       average(@ta-dark-text-color, @ta-dark-color-info);
@ta-dark-state-info-bg:                  @ta-dark-color-info;
@ta-dark-state-info-border:              darken(spin(@ta-dark-state-info-bg, -10), 7%);

@ta-dark-state-warning-text:             @ta-dark-text-color;
@ta-dark-state-warning-text-emphasis:    average(@ta-dark-text-color, @ta-dark-color-warning);
@ta-dark-state-warning-bg:               @ta-dark-color-warning;
@ta-dark-state-warning-border:           darken(spin(@ta-dark-state-warning-bg, -10), 20%);

@ta-dark-state-danger-text:              @ta-dark-text-color;
@ta-dark-state-danger-text-emphasis:     average(@ta-dark-text-color, @ta-dark-color-danger);
@ta-dark-state-danger-bg:                @ta-dark-color-danger;
@ta-dark-state-danger-border:            darken(spin(@ta-dark-state-danger-bg, -10), 5%);

@dark-text-color: #f3f3f3;
@dark-background-color: rgba(50, 50, 65, .93);
@dark-background-color-transparent: rgba(80, 80, 90, 0.65);
@dark-background-color-light: rgb(80, 80, 90);
@dark-border-color: rgba(0, 0, 0, 0.15);
@dark-input-border: rgb(95, 95, 95);
@dark-input-background: rgba(95, 95, 95, .1);

.theme-dark {
  --ta-color-primary:         @ta-dark-color-primary;
  --ta-color-success:         @ta-dark-color-success;
  --ta-color-info:            @ta-dark-color-info;
  --ta-color-warning:         @ta-dark-color-warning;
  --ta-color-danger:          @ta-dark-color-danger;

  --ta-state-primary-text:             @ta-dark-state-primary-text;
  --ta-state-primary-text-emphasis:    @ta-dark-state-primary-text-emphasis;
  --ta-state-primary-bg:               @ta-dark-state-primary-bg;
  --ta-state-primary-border:           @ta-dark-state-primary-border;

  --ta-state-success-text:             @ta-dark-state-success-text;
  --ta-state-success-text-emphasis:    @ta-dark-state-success-text-emphasis;
  --ta-state-success-bg:               @ta-dark-state-success-bg;
  --ta-state-success-border:           @ta-dark-state-success-border;

  --ta-state-info-text:                @ta-dark-state-info-text;
  --ta-state-info-text-emphasis:       @ta-dark-state-info-text-emphasis;
  --ta-state-info-bg:                  @ta-dark-state-info-bg;
  --ta-state-info-border:              @ta-dark-state-info-border;

  --ta-state-warning-text:             @ta-dark-state-warning-text;
  --ta-state-warning-text-emphasis:    @ta-dark-state-warning-text-emphasis;
  --ta-state-warning-bg:               @ta-dark-state-warning-bg;
  --ta-state-warning-border:           @ta-dark-state-warning-border;

  --ta-state-danger-text:              @ta-dark-state-danger-text;
  --ta-state-danger-text-emphasis:     @ta-dark-state-danger-text-emphasis;
  --ta-state-danger-bg:                @ta-dark-state-danger-bg;
  --ta-state-danger-border:            @ta-dark-state-danger-border;

  --ta-text-color: @dark-text-color;
  --ta-text-color-faded: fadeout(@dark-text-color, 30%);
  --ta-text-color-inverted: black;
  --ta-text-color-gray: #9f9f9f;
  --ta-bg-color: @dark-background-color;
  --ta-bg-color-semi-transparent: @dark-background-color-transparent;
  --ta-bg-color-semi-transparent-muted: #3e3e3ea6;
  --ta-bg-color-solid: fade(@dark-background-color, 100%);
  --ta-bg-color-disabled: rgba(128, 128, 128, 0.45);
  --ta-bg-dim-overlay: rgba(0, 0, 0, .35);
  --ta-special-button-section-bg: #5d5d5d40;
  --ta-special-button-section-border: rgba(154, 154, 154, .2);
  --ta-panel-border-color: @dark-border-color; // dark
  --ta-border-color-disabled: #ccc;
  --ta-inner-border-color: @dark-border-color; // dark
  --ta-inner-border-color-gradient-end: rgba(0, 0, 0, 0);
  --ta-inner-border-color-light: rgba(255, 255, 255, .5);
  --ta-inner-border-color-light-gradient-end: rgba(255, 255, 255, 0);

  --ta-hover-color: rgba(255, 255, 255, .15);
  --ta-active-color: rgba(0, 0, 0, 0.1);
  --ta-selection-color: #3a5573cc;

  --ta-link-color: lighten(@ta-dark-color-primary, 20%);
  --ta-link-hover-color: lighten(@ta-dark-color-primary, 25%);
  --ta-link-hover-decoration: underline;

  --ta-pre-color: #333;

  //== Buttons
  --ta-btn-font-weight:                var(--ta-font-weight-normal);
  --ta-btn-default-border:             var(--ta-panel-border-color);
  --ta-btn-default-bg:                 var(--ta-bg-color);
  --ta-btn-border-radius-base:         var(--ta-border-radius);


  //== Forms
  --ta-input-bg:                      @dark-input-background;
  --ta-input-bg-disabled:             var(--ta-bg-color-disabled);
  --ta-input-border-color:            @dark-input-border;
  --ta-input-border-radius:           var(--ta-border-radius);
  --ta-input-border-focus:            var(--ta-color-info);
  --ta-input-height:                  calc(var(--ta-line-height-computed) + var(--ta-padding-base-vertical) * 2 + 2px);
  --ta-input-color:                   var(--ta-text-color);
  --ta-input-color-placeholder:       #f3f3f355;


  //== Misc.
  --ta-box-shadown-color: rgba(0, 0, 0, .3);

  //== Component-Specific
  --ta-calendar-grid-border-color: #6363631a;
  --ta-calendar-grid-non-business-bg-color: #d7d7d755;
  --ta-calendar-day-occupation-background-circle-color: #d7d7d729;
  --ta-calendar-day-occupation-today-bg: rgba(255, 168, 61, 0.31);

  // == button-style-item
  --ta-3d-button-gradient:         linear-gradient(to bottom, rgba(255, 255, 255, 0.1) 0%, rgba(251, 251, 252, 0.1) 62%, rgba(247, 248, 249, 0.1) 84%, rgba(245, 246, 247, 0.1) 94%, rgba(237, 239, 241, 0.1) 100%);
  --ta-3d-button-gradient-lowered: linear-gradient(to bottom, rgba(200, 200, 200, 0.1) 0%, rgba(190, 190, 190, 0.1) 62%, rgba(185, 185, 185, 0.1) 84%, rgba(180, 180, 180, 0.1) 94%, rgba(175, 175, 175, 0.1) 100%);
  --ta-glow-gradient: linear-gradient(to bottom, #feeeac22 0%,#fee5a622 7%,#fee7a822 92%,#fef4b022 97%,#fef7b422 100%);
  --ta-glow-gradient-lowered: linear-gradient(to bottom, #fef7b422 0%,#fef4b022 7%,#fee7a822 92%,#fee5a622 97%,#feeeac22 100%);
  --ta-glow-border-color: darken(#C19344, 30%);

  
  html {
    scrollbar-face-color: var(--ta-input-border-color);
    scrollbar-base-color: var(--ta-input-border-color);
    scrollbar-3dlight-color: var(--ta-input-border-color);
    scrollbar-highlight-color: var(--ta-input-border-color);
    scrollbar-track-color: var(--ta-bg-color);
    scrollbar-arrow-color: var(--ta-bg-color);
    scrollbar-shadow-color: var(--ta-input-border-color);
    scrollbar-dark-shadow-color: var(--ta-input-border-color);
  }

  ::-webkit-scrollbar { width: 8px; height: 3px;}
  ::-webkit-scrollbar-button {  background-color: var(--ta-input-border-color); }
  ::-webkit-scrollbar-track {  background-color: var(--ta-input-border-color);}
  ::-webkit-scrollbar-track-piece { background-color: var(--ta-bg-color);}
  ::-webkit-scrollbar-thumb { height: 50px; background-color: var(--ta-input-border-color); border-radius: 3px;}
  ::-webkit-scrollbar-corner { background-color: var(--ta-input-border-color);}
  ::-webkit-resizer { background-color: var(--ta-input-border-color);}

  .Toolbar {
    > .background-color-div {
      > .inner-container .button-group-wrapper > .toolbar-group-separator {
        border-right: 1px solid rgba(78, 78, 78, 0.5);
      }
    }
    .toolbar-button-wrapper:hover, .Toolbar-size-testing-container .toolbar-button-wrapper:hover {
      background-color: @dark-background-color-light;
    }
  }

  .ToolAccordion {
    .toolbar-button-wrapper:hover {
      background-color: @dark-background-color-light;
    }
  }

  .Panel {
    .panel-heading {
      .panel-heading-window-buttons > .ToolButton {
        filter: invert(100%);
      }

      .panel-component-wrapper > .icon-and-field-wrapper {
        background-color: rgba(255, 255, 255, 0.07);
      }
    }
  }

  .TabPanel {
    > .tab-panel-header > .background-color-div {
      .tab-button .tab-button-close-button {
        filter: invert(100%);
      }
    }

    .window-button-container .ToolButton.img {
      filter: invert(100%);
    }
  }

  .Notification .close-button {
      filter: invert(100%);
  }

  .ItemView .item-group .item-group-header:after {
    bottom: 0;
    background: linear-gradient(to right, rgba(78, 78, 78, 0.5) 0%, rgba(78, 78, 78, 0.5) 50%, rgba(0, 0, 0, 0) 100%);
  }

  .InfiniteItemView > .slickgrid .item-wrapper > *:hover {
    border-color: @dark-border-color;
    background: linear-gradient(to bottom, @dark-background-color 0%, @dark-background-color 62%, @dark-background-color-light 100%);
  }

  .InfiniteItemView {
    user-select: none;
    overflow: auto;

    --item-position-animation-time: .5s;

    > .grid {
      position: relative;
      overflow: hidden;
      contain: strict; // !!!

      .item-wrapper {
        position: absolute;
        transition: top var(--item-position-animation-time) ease, left var(--item-position-animation-time) ease;
        contain: strict; // !!!
        display: flex;
      }
    }
  }

  .UiGridForm {
    display: flex;
    flex-direction: column;

    .UiFormSection {
      flex: 0 0 auto;
      display: flex;
      flex-direction: column;

      > .header {
        display: flex;
        align-items: center;

        > .expand-button {
          padding: 2px;
          display: flex;
          align-items: center;
          border: 1px solid transparent;
        }
        > .header-line {
          position: relative;
          flex: 1 1 0;
        }
      }

      &.draw-header-line {
        .header-line:before, .header-line:after {
          position: absolute;
          display: block;
          width: 100%;
          bottom: 1px;
          left: 0;
          content: '';
          height: 1px;
          background: linear-gradient(to right, rgba(0, 0, 0, 0.1) 0%, rgba(0, 0, 0, 0.1) 85%, rgba(0, 0, 0, 0) 100%);
        }
        .header-line:after {
          bottom: 0;
          background: linear-gradient(to right, rgba(255, 255, 255, .5) 0%, rgba(255, 255, 255, .5) 85%, rgba(255, 255, 255, 0) 100%);
        }
      }

      &.has-header-template {
        .expand-button {
          margin-right: 8px;
        }
        .teamapps-expander {
          margin-right: 7px;
        }
      }
      &:not(.has-header-data):not(.collapsible) {
        .header {
          display: none;
        }
      }

      .body {
        display: grid;
      }

      &.fill-remaining-height:not(.collapsed) {
        flex: 1 0 auto;
        .body {
          flex: 1 0 auto;
        }
      }
    }

    .UiFormSectionFloatingFieldsPlacement {
      display: flex;
      align-items: baseline;

      > * {
        flex: 1 1 auto;
      }
    }

    .tmp-container {
      .pseudo-hidden;
    }
  }

  .UiDropDown {
    border-color: var(--ta-panel-border-color); // TODO @dark-border-color, chrome bug...

    .background-color-div {
      background-color: @dark-background-color-transparent;
    }
  }

  .UiField {
    .field-border,
    .field-border-visibility {
      border-color: @dark-input-border;
    }
    .field-background {
      background-color: @dark-input-background;
    }

    &.readonly .field-background,
    &.editable-if-focused:not(.focus):not(:hover) .field-background {
      background: transparent;
    }

    &.readonly .field-border,
    &.readonly .field-border-visibility,
    &.editable-if-focused:not(.focus):not(:hover) .field-border,
    &.editable-if-focused:not(.focus):not(:hover) .field-border-visibility {
      border-color: transparent;
    }
  }

  .UiButton {
    &:hover,
    &:focus,
    &.focus {
      color: lighten(@dark-text-color, 20%);
    }
  }

  .UiWorkSpaceLayout .minimized-tabpanel-bar {
    background-color: @dark-background-color;

    .minimized-tabpanel-button {
      border: @dark-border-color;
      background-color: @dark-background-color-light;

      >.tab-icon:first-child {
        filter: invert(100%);
      }
    }
  }

  .Table {
    .slick-cell {
      border-bottom-color: @dark-border-color;
    }
    .slick-cell.selected,
    .slick-table.list-mode .slick-cell.selected {
      background-color: rgba(102, 174, 255, 0.45);
    }
    &.striped-rows .slick-row.odd {
      background-color: rgba(255, 255, 255, .05);
    }
    .slick-headerrow {
      background-color: rgba(255, 255, 255, .05);
      border-bottom-color: @dark-border-color;
    }
    .slick-footerrow {
      background-color: rgba(255, 255, 255, .05);
      border-color: @dark-border-color;
    }
  }

  .UiChatInput {
    background-color: var(--ta-input-bg);
    border-top-color: var(--ta-input-border-color);

    textarea {
      background-color: transparent;
    }
  }

  .UiMediaTrackGraph {
    .area {
      fill: rgb(96, 185, 255);
      fill-opacity:0.20;
      clip-path: url(#clip);
    }

    .area2 {
      fill: rgb(92, 170, 252);
      fill-opacity:0.30;
      clip-path: url(#clip);
    }

    .line {
      stroke: rgb(87, 177, 243);
      stroke-width: 0.9;
      stroke-opacity:1.0;
      fill: none;
      //filter: url(#drop-shadow);
      clip-path: url(#clip);
    }

    .line2 {
      stroke: rgb(77, 129, 210);
      stroke-width: 0.9;
      stroke-opacity:1.0;
      fill: none;
      clip-path: url(#clip);
    }

    .marker {
      stroke: rgb(139, 116, 31);
      stroke-width: 0.3;
      stroke-opacity:1.0;
      fill: rgb(139, 116, 31);
      fill-opacity:0.50;
      clip-path: url(#clip);
    }

    .cursor {
      stroke: rgb(255, 201, 0);
      stroke-width: 1.7;
      stroke-opacity:1.0;
      fill: none;
    }

    .axis path,
    .axis line {
      fill: none;
      stroke: #f7f6f9;
      shape-rendering: crispEdges;
    }

    .brush {
      stroke: #ff9f5a;
      stroke-width: 1.0;
      stroke-opacity: 1;
      stroke-dasharray: 3, 1;
      fill: #ffed0c;
      fill-opacity: .3;
      shape-rendering: crispEdges;
      pointer-events: all;
    }


    rect.pane {
      cursor: move;
      fill: none;
      pointer-events: all;
    }
  }

  .tr-tagcombobox-default-wrapper-template {
    border: 1px solid @dark-input-border;
    box-shadow: 1px 2px 1px -1px rgba(0, 0, 0, 0.13);
    background-color: @dark-input-background;

    .tr-remove-button {
      border: 1px solid @dark-input-border;
    }
  }

  .tr-remove-button,
  .teamapps-expander,
  .file-list:empty:before {
    filter: invert(100%);
  }

  .tr-highlighted-text {
    background-color: rgba(244, 195, 125, 0.7);
    box-shadow: 1px 1px 3px 0 rgba(0, 0, 0, 0.75);
  }

  .tr-dropdown {
    background-color: @dark-background-color;
    border: @dark-input-border;
  }

  .UiFloatingComponent .expander-handle:after {
    filter: invert(100%);
  }

  .UiProgressDisplay .cancel-button {
    filter: invert(100%);
  }

  .calendar-symbol-page {
    stroke: transparent;
  }
}

